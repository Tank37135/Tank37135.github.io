<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="keywords" content="博客, 生活简报">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tank37135的生活简报</title>
    <meta name="description" content="Tank37135的生活简报，记录生活">
    <link rel="icon" href="/assets/images/logo/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/assets/style/main.css">
    <link rel="stylesheet" type="text/css" href="/assets/style/style.css">
    <link rel="stylesheet" type="text/css" href="/assets/style/subassembly.css">
    <link rel="stylesheet" type="text/css" href="/assets/style/background.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" media="screen" href="https://fontlibrary.org//face/source-code-pro" type="text/css" />
    <style>
        main {
            top: 20px;
        }

        .loading {
            font-size: 20px;
            color: rgba(255, 255, 255, 0.75);
            font-weight: bold;
        }

        .error-message {
            color: rgba(255, 255, 255, 0.75);
            font-size: 18px;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <header class="header">
        <h1>简报</h1>
    </header>
    <main>
        <div class="articles-container" id="articleResults">
            <div id="loadingMessage" class="loading">正在载入...</div>
            <div id="errorMessage" class="error-message" style="display: none;">加载XML文件失败，请稍后再试。</div>
        </div>
    </main>

    <script>
        let allCards = [];  // 用于存储所有卡片数据

        // 加载并解析 XML 文件
        function loadXMLDoc(filename) {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState === 4) {
                    if (this.status === 200) {
                        displayCards(this); // 如果加载成功，显示卡片
                    } else {
                        displayError(); // 如果加载失败，显示错误信息
                    }
                }
            };
            // 修改为新的文件路径
            xhttp.open("GET", "/assets/data/briefing.xml", true);
            xhttp.send();
        }

        // 显示所有卡片，并根据时间排序
        function displayCards(xml) {
            var xmlDoc = xml.responseXML;
            var cards = xmlDoc.getElementsByTagName("Card");
            allCards = []; // 清空之前的数据

            for (var i = 0; i < cards.length; i++) {
                var card = cards[i];
                var time = card.getElementsByTagName("Time")[0].childNodes[0].nodeValue;
                var title = card.getElementsByTagName("Title")[0].childNodes[0].nodeValue;
                var text = card.getElementsByTagName("Text")[0].childNodes[0].nodeValue;

                allCards.push({
                    time: time,
                    title: title,
                    text: text
                });
            }

            // 按时间降序排列
            allCards.sort((a, b) => new Date(b.time) - new Date(a.time));

            // 隐藏加载信息，显示卡牌
            document.getElementById("loadingMessage").style.display = "none";
            renderCards(allCards);
        }

        // 根据数据渲染卡牌
        function renderCards(cards) {
            var container = document.getElementById("articleResults");
            container.innerHTML = '';  // 清空容器

            cards.forEach(card => {
                var cardElement = document.createElement("div");
                cardElement.classList.add("article-card");

                cardElement.setAttribute("data-tags", "exampleTag");

                cardElement.innerHTML = `
                    <div class="article-date">
                        <i class="bi bi-calendar-check-fill"></i> ${card.time}
                    </div>
                    <div class="article-title">${card.title}</div>
                    <div class="article-excerpt">${card.text}</div>
                `;

                container.appendChild(cardElement);
            });
        }

        // 显示加载错误信息
        function displayError() {
            document.getElementById("loadingMessage").style.display = "none";
            document.getElementById("errorMessage").style.display = "block";
        }

        // 初次加载 XML 数据
        loadXMLDoc("/assets/data/briefing.xml");
    </script>
    <footer>
        &copy; 2025 Tank37135. All rights reserved.<br>
        本页是对于生活中的一些事情的简要记录，不具有评论性，仅记录所以移除了搜索功能，还有他们仅是文章卡牌，没有链接
    </footer>
</body>

</html>
