<!doctype html>
<html lang="zh">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="UTF-8" />
    <title>代码流星雨原理讲解|源代码下载</title>
    <meta name="description" content="超级炫酷的代码流星雨，黑客帝国风格效果，附带制作教程，代码解析，也可以直接下载源代码">
    <meta name="keywords" content="Tank37135博客, 代码流星雨, 黑客帝国">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../../assets/style/main.css">
    <link rel="stylesheet" type="text/css" href="../../assets/style/style.css">
    <link rel="stylesheet" type="text/css" href="../../assets/style/subassembly.css">
    <link rel="stylesheet" type="text/css" href="../../assets/style/background.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" media="screen" href="https://fontlibrary.org//face/source-code-pro" type="text/css" />
  </head>
  <body class="body">
  <header><h2>Tank37135文章</h2></header>
  <main class="main">
    
    <article>
      <section class="section">
      <h1>炫酷的代码流星雨</h1>
      <p>这个代码在很多黑客电影都见过，以前觉得他很帅，现在才发现现实中几乎不会出现这种场景。</p>
      <p>下面我们将用一段代码来模拟这个场景。</p>
      <p>这个代码会生成代码流星雨的效果，我已经提前把它作为背景固定并且置于底层，可以下载代码然后直接添加内容</p>
      <p>保存到一个后缀为HTML或HTM的文件中，双击即可食用。</p>

      <p><a href="rain.html" target="_blank">预览代码</a>
      或者
      <a href="rain.html" download="rain.html">点击下载文件</a></p>
      </section>
      <section class="section">
      <h2>原理剖析</h2>
       <p>首先要保证有良好的视觉体验，所以设置body元素的外边距为0，并且隐藏滚动条。为了使canvas占据整个视口，不会有空白区域或滚动条干扰。<br>所以我们可以用CSS这样规定它</p>
       <div class="code-block">
       <button onclick="copyCode(this)">CSS复制</button>
       <pre><code class="code2">
         body {
         margin: 0;
         overflow: hidden;
         }
      </code></pre>
      </div>
      <p>接着，我们需要把背景变成黑色的，我们可以通过创建一个画布来实现</p>
       <div class="code-block">
       <button onclick="copyCode(this)">html复制</button>
       <pre><code class="code2">
       &lt;canvas id="canvas" style="background:#000000;"&gt;&lt;/canvas&gt;
      </code></pre>
      </div>
      <p>然后处理事件，首先获取Canvas元素及其绘图上下文</p>
       <div class="code-block">
       <button onclick="copyCode(this)">js复制</button>
       <pre><code class="code2">
        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext("2d");
      </code></pre>
      </div>
      <p>为了解决高度问题，我们可以设置画布的宽度和高度为窗口当前大小</p>
       <div class="code-block">
       <button onclick="copyCode(this)">js复制</button>
       <pre><code class="code2">
         var w = window.innerWidth;
         var h = window.innerHeight;
         canvas.width = w;
         canvas.height = h;
      </code></pre>
      </div>
      <p>现在要告诉系统字体和排列数，我们让他定义字体大小fontSize为14px，计算每行可以放多少个字符</p>
       <div class="code-block">
       <button onclick="copyCode(this)">js复制</button>
       <pre><code class="code2">
         var fontSize = 14; 
         var clos = Math.floor(w / fontSize);
      </code></pre>
      </div>
      <p>创建一个数组drops用来记录每一列下落的位置</p>
       <div class="code-block">
       <button onclick="copyCode(this)">js复制</button>
       <pre><code class="code2">
         var drops = [];
         for (var i = 0; i < clos; i++) {
             drops.push(0);
         }
      </code></pre>
      </div>
      <p>定义字符串str为一组小写字母，从“q”到“m”，用于随机生成下落的字符</p>
       <div class="code-block">
       <button onclick="copyCode(this)">js复制</button>
       <pre><code class="code2">
         var str = "qwertyuiopasdfghjklzxcvbnm";
      </code></pre>
      </div>
      <p>清空画布，设置fillStyle为半透明黑色，覆盖整个canvas，模拟背景的逐渐暗淡</p>
       <div class="code-block">
       <button onclick="copyCode(this)">js复制</button>
       <pre><code class="code2">
         ctx.fillStyle = "rgba(0,0,0,0.05)";
         ctx.fillRect(0, 0, w, h);
      </code></pre>
      </div>
      <p>设置字体样式和颜色</p>
       <div class="code-block">
       <button onclick="copyCode(this)">js复制</button>
       <pre><code class="code2">
         ctx.font = "600 " + fontSize + "px 流星雨";
         ctx.fillStyle = "#00ff00"; 
      </code></pre>
      </div>
      <p>循环遍历每一列，绘制字符并调整下落的位置</p>
       <div class="code-block">
       <button onclick="copyCode(this)">js复制</button>
       <pre><code class="code2">
         for (var i = 0; i < clos; i++) {
           var x = i * fontSize;
           var y = drops[i] * fontSize;
    
           ctx.fillText(str[Math.floor(Math.random() * str.length)], x, y);
     
           if (y > h && Math.random() > 0.99) {
               drops[i] = 0;
           }
    
           drops[i]++;
         }
      </code></pre>
      </div>
      <p>使用setInterval(drawString, 30);每30毫秒调用一次drawString函数，保持动画效果。</p>
      <p>窗口大小调整处理</p>
       <div class="code-block">
       <button onclick="copyCode(this)">js复制</button>
       <pre><code class="code2">
         window.onresize = function() {
           // 更新窗口大小、画布尺寸以及重置drops数组
           w = window.innerWidth;
           h = window.innerHeight;
           canvas.width = w;
           canvas.height = h;
           clos = Math.floor(w / fontSize);
    
           // 重置drops数组为全0，以适应新的列数
           drops = [];
           for (var i = 0; i < clos; i++) {
               drops.push(0);
           }
         }; 
      </code></pre>
      </div>
      <p>OK，以上就是大致原理，快拿去玩吧</p>
      </section>
    </article>

    <aside>
      <section class="section centerbox">
      <img class="avatar" src="../../assets/images/png/home.png" alt="Tank37135">
      <a href="https://Tank37135.github.io">Tank37135 Blog</a>
      </section>
      <section class="section">
        <h3>划线笔记</h3>
        <p><a href="rain.html" target="_blank">预览代码效果</a><br><a href="rain.html" download="rain.html">下载代码文件</a></p>
      </section>
      <section class="section">
        <h3>历史文章</h3>
        <a href="18.html">搞恶页面</a><br>
        <a href="essay1.html">国旗的获取及运用</a><br>
        <a href="computer-win.html">windows系统有关教程，滚动更新</a>
      </section>
      <section class="section">
        <h3>快捷链接</h3>
        <a href="https://Tank37135.github.io">首页</a><br>
        <a href="index.html">博客文章</a><br>
        <a href="../tools/">在线工具</a><br>
        <a href="/about.html">关于本站</a><br>
      </section>
      <section class="section">
        <h3>在其他地方</h3>
        <a href="https://space.bilibili.com/3546812994554001" target="_blank">bilibili</a><br>
        <a href="https://github.com/Tank37135">Github</a>
      </section>
      <section class="section">
        <h3>本文信息</h3>
        <ul>
          <li><p>发布时间:<br>完了！时间让Tank37135给忘记了</p></li>
          <li><p>最后修改日期:<br>2025年7月27日</p></li>
        </ul>
      </section>
    </aside>
  </main>
  <footer><a href="https://Tank37135.github.io">&copy; 2025 Tank37135. All rights reserved.</a></footer>
  <script type="text/javascript" src="../../assets/script/background.js"></script>
  <script type="text/javascript" src="../../assets/script/script.js"></script>
  <script type="text/javascript" src="../../assets/script/subassembly.js"></script>
  </body>
</html>